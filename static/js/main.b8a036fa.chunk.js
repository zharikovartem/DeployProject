(this["webpackJsonpepam-app"]=this["webpackJsonpepam-app"]||[]).push([[0],{185:function(e,t,a){},186:function(e,t,a){},332:function(e,t,a){"use strict";a.r(t);var s,n=a(8),r=a(0),c=a(24),l=a.n(c),o=(a(185),a(186),a(49)),i=a(42),u=a(338),d=a(26),j=a.n(d),f=a(44),m=a(342),b=a(340),D=a(177),h=a(343),p=a(130),g=a(335),O=a(336),v=a(55),S={labelCol:{span:8},wrapperCol:{span:16}},k={wrapperCol:{offset:8,span:16}},Y=m.a.TextArea,x=function(e){var t=b.a.useForm(),a=Object(i.a)(t,1)[0],s=Object(r.useState)(e.selectedDate),c=Object(i.a)(s,2),l=c[0],o=c[1],u=Object(r.useState)(e.taskSaveStatus),d=Object(i.a)(u,2),x=d[0],I=d[1];Object(r.useEffect)((function(){switch(console.log("status changed: ",e.taskSaveStatus),e.taskSaveStatus){case"inProgress":I(e.taskSaveStatus);break;case"success":D.b.success("The task was successfully created"),e.onClose(),I("");break;case"error":D.b.error("Error: "+e.errorMessage),I(e.taskSaveStatus)}}),[e.taskSaveStatus]);var T=function(){a.resetFields(["description"])};return Object(n.jsx)(h.a,{title:"Create New Task for "+l.format("DD MMM YYYY"),placement:"right",closable:!0,onClose:e.onClose,visible:e.visible,width:"80%",children:Object(n.jsxs)(b.a,Object(f.a)(Object(f.a)({},S),{},{form:a,name:"control-hooks",initialValues:{remember:!0},onFinish:function(t){console.log("onFinish, reload: ",l!==e.selectedDate);var s={date:t.date.format("YYYY-MM-DD"),taskTime:t.taskTime.format("HH:mm"),taskName:t.taskName,user_id:1,description:t.description};console.log(l.format("DD"),"<",e.dateInterval.startDate.format("DD"),">",e.dateInterval.startDate.format("DD")),console.log(j()(l.format("YYYY-MM-DD")).isBetween(e.dateInterval.startDate.format("YYYY-MM-DD"),e.dateInterval.endDate.format("YYYY-MM-DD"),void 0,"[]")),console.log("selectedDate",l.format("YYYY-MM-DD HH:MM:SS")),console.log("startDate",e.dateInterval.startDate.format("YYYY-MM-DD HH:MM:SS")),console.log("endDate",e.dateInterval.endDate.format("YYYY-MM-DD HH:MM:SS")),j()(l.format("YYYY-MM-DD")).isBetween(e.dateInterval.startDate.format("YYYY-MM-DD"),e.dateInterval.endDate.format("YYYY-MM-DD"),void 0,"[]")?(e.createNewTask(s,!0),console.log("\u041f\u0415\u0420\u0415\u0420\u0418\u0421\u041e\u0412\u041a\u0410")):(console.log("\u041f\u0415\u0420\u0415\u0420\u0418\u0421\u041e\u0412\u041a\u0418 \u041d\u0415\u0422"),e.createNewTask(s,!1)),a.resetFields(["taskName"]),T()},children:[Object(n.jsx)(b.a.Item,{label:"Task name",name:"taskName",rules:[{required:!0,message:"Please input task name!"}],children:Object(n.jsx)(m.a,{})}),Object(n.jsx)(b.a.Item,{label:"Task date",name:"date",initialValue:e.selectedDate,rules:[{required:!0,message:"Please input task date!"}],children:Object(n.jsx)(p.a,{onChange:function(e,t){null!==e&&o(e)},format:"DD-MM-YYYY"})}),Object(n.jsx)(b.a.Item,{label:"Task time",name:"taskTime",rules:[{required:!0,message:"Please input task time!"}],children:Object(n.jsx)(g.a,{format:"HH:mm"})}),Object(n.jsx)(b.a.Item,{label:"Description",name:"description",children:Object(n.jsx)(Y,{rows:2})}),Object(n.jsx)(b.a.Item,Object(f.a)(Object(f.a)({},k),{},{children:"inProgress"===x?Object(n.jsx)(O.a,{}):Object(n.jsx)(v.a,{type:"primary",htmlType:"submit",children:"Create"})})),Object(n.jsx)(v.a,{type:"primary",onClick:function(){a.setFieldsValue({taskName:"Hello world!",description:"male"})},children:"clear"})]}))})},I=a(50),T=a.n(I),M=a(82),L=a(169),N=a.n(L).a.create({withCredentials:!0,baseURL:"https://crmapiserver.h1n.ru/api/"});!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(s||(s={}));var y=function(e){return N.get("tasks?date=".concat(e)).then((function(e){return 200===e.status?e:null})).catch((function(e){return e.response?(console.log("err",e.response),e.response):(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},w=function(e){return N.post("tasks",e).then((function(e){return 200===e.status?e:null})).catch((function(e){return e.response?e.response:(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},E=function(e){return console.log("getTaskListForGap API",e),N.post("tasks/part",e).then((function(e){return console.log("response",e),200===e.status?e:null})).catch((function(e){return e.response?(console.log("err"),e.response):(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},F=function(e){return N.delete("tasks/".concat(e)).then((function(e){return 200===e.status?e:null}))},A=function(e){return"date"===e?function(e,t){return e.date>t.date?1:-1}:function(e,t){return e.time>t.time?-1:1}},C={taskList:null,taskListIsFetching:!1,taskSaveStatus:"no",errorMessage:null,isInterval:!1,dateInterval:{startDate:j()(),endDate:j()()}},_={setTaskList:function(e){return{type:"SN/TASK/SET_TASK_LIST",taskList:e}},setTaskSaveStatus:function(e){return{type:"SN/TASK/SET_TASK_SAVE_STATUS",taskSaveStatus:e}},setErrorMessage:function(e){return{type:"SN/TASK/SET_ERROR_MESSAGE",message:e}},setTaskListIsFetching:function(e){return{type:"SN/TASK/SET_TASK_LIST_IS_FETCHING",isFetchingValue:e}},setIsInterval:function(e,t){return{type:"SN/TASK/SET_IS_INTERVAL",isInterval:e,date:t}}},K=function(e){return function(){var t=Object(M.a)(T.a.mark((function t(a,s){var n;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(_.setTaskListIsFetching(!0)),console.log("setTaskListIsFetching true"),t.next=4,y(e);case 4:null!==(n=t.sent)&&(a(_.setTaskList(n.data)),a(_.setTaskListIsFetching(!1)),console.log("setTaskListIsFetching false"));case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},H=function(e,t){return console.log("getTaskListForGap",e,"-",t),function(){var a=Object(M.a)(T.a.mark((function a(s,n){var r,c;return T.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s(_.setTaskListIsFetching(!0)),r={start_date:e,end_date:t},a.next=4,E(r);case 4:c=a.sent,console.log(c),null!==c&&s(_.setTaskList(c.data)),s(_.setTaskListIsFetching(!1));case 8:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SN/TASK/SET_TASK_LIST":return Object(f.a)(Object(f.a)({},e),{},{taskList:t.taskList.Tasks.sort(A("time")).sort(A("date"))});case"SN/TASK/SET_TASK_SAVE_STATUS":return Object(f.a)(Object(f.a)({},e),{},{taskSaveStatus:t.taskSaveStatus});case"SN/TASK/SET_ERROR_MESSAGE":return Object(f.a)(Object(f.a)({},e),{},{errorMessage:t.message});case"SN/TASK/SET_TASK_LIST_IS_FETCHING":return Object(f.a)(Object(f.a)({},e),{},{taskListIsFetching:t.isFetchingValue});case"SN/TASK/SET_IS_INTERVAL":var a={startDate:t.date.startDate,endDate:t.date.endDate};return console.log("in Reducer: ",a.startDate.format("DD"),"-",a.endDate.format("DD")),Object(f.a)(Object(f.a)({},e),{},{isInterval:t.isInterval,dateInterval:a});default:return e}},G=Object(o.b)((function(e){return{taskList:e.task.taskList,taskSaveStatus:e.task.taskSaveStatus,errorMessage:e.task.errorMessage,dateInterval:e.task.dateInterval}}),{createNewTask:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){var a=Object(M.a)(T.a.mark((function a(s,n){var r;return T.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s(_.setTaskSaveStatus("inProgress")),a.next=3,w(e);case 3:200===(r=a.sent).status?(t&&s(_.setTaskList(r.data)),s(_.setTaskSaveStatus("success")),s(_.setTaskSaveStatus("no"))):(s(_.setErrorMessage(r.data.message)),s(_.setTaskSaveStatus("error")),s(_.setTaskSaveStatus("no")),s(_.setErrorMessage(null)));case 5:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()}})(x),q=a(344),R=a(345),P=a(346),z=p.a.RangePicker,B=function(e){var t=Object(r.useState)(!1),a=Object(i.a)(t,2),s=a[0],c=a[1],l=Object(r.useState)({startDate:j()(),endDate:j()()}),o=Object(i.a)(l,2),u=o[0],d=o[1];Object(r.useEffect)((function(){console.log("useEffect setIsInterval in ToDoHeader: ","p-s",e.dateInterval.startDate.format("DD"),"p-e",e.dateInterval.endDate.format("DD")),console.log(),e.setIsInterval(s,u)}),[s,u]);return Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"col-12 col-md-8 col-lg-6",children:[Object(n.jsx)("div",{className:"d-none d-sm-inline",children:Object(n.jsxs)("label",{children:["Select ",s?"date interval":"date",":"]})}),Object(n.jsx)("div",{className:"d-inline",children:s?Object(n.jsx)(z,{onChange:function(e,t){null!==e&&null!==e[0]&&null!==e[1]&&d({startDate:e[0],endDate:e[1]})},defaultValue:[e.selectedDate,e.selectedDate],value:[e.dateInterval.startDate,e.dateInterval.endDate],format:"DD-MM-YYYY",style:{marginLeft:10}}):Object(n.jsx)(p.a,{onChange:function(e,t){null!==e&&d({startDate:e,endDate:e})},defaultValue:e.dateInterval.startDate,format:"DD-MM-YYYY",style:{marginLeft:10}})})]}),Object(n.jsx)("div",{className:"col-12 col-md-4 col-lg-2 m-2 m-md-0",children:Object(n.jsx)(q.a,{className:"ml-3",onChange:function(t){t.target.checked||(console.log("\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043e\u0434\u043d\u0443 \u0434\u0430\u0442\u0443 \u0435\u0441\u043b\u0438 \u043e\u043d\u0438 \u0440\u0430\u0437\u043d\u044b\u0435 startDate: ",u.startDate.format("DD")," ?== ",e.dateInterval.startDate.format("DD")),console.log("\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043e\u0434\u043d\u0443 \u0434\u0430\u0442\u0443 \u0435\u0441\u043b\u0438 \u043e\u043d\u0438 \u0440\u0430\u0437\u043d\u044b\u0435 endDate: ",u.endDate.format("DD")," ?== ",e.dateInterval.endDate.format("DD")),d({startDate:u.startDate,endDate:u.startDate}),console.log("setDates runing")),c(t.target.checked)},children:"Date interval"})}),Object(n.jsxs)("div",{className:"col-12 col-md-12 col-lg-4",children:[Object(n.jsx)(v.a,{type:"primary",shape:"round",icon:Object(n.jsxs)("div",{className:"d-flex flex-wrap align-content-start",children:[Object(n.jsx)(R.a,{style:{fontSize:"18px"}}),Object(n.jsx)("span",{className:"ml-1",style:{fontSize:"14px"},children:"Add"})]}),style:{marginLeft:10},onClick:e.showDrawer,disabled:e.isAddActive}),Object(n.jsx)(v.a,{className:"",type:"primary",shape:"round",style:{marginLeft:10},onClick:e.showModal,icon:Object(n.jsxs)("div",{className:"d-flex flex-wrap align-content-start",children:[Object(n.jsx)(P.a,{style:{fontSize:"18px"}}),Object(n.jsx)("span",{className:"ml-1",style:{fontSize:"14px"},children:"Settings"})]})})]})]})},U=Object(o.b)((function(e){return{dateInterval:e.task.dateInterval}}),{setIsIntervalAC:function(e){return function(){var e=Object(M.a)(T.a.mark((function e(t,a){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},getTaskList:K,setIsInterval:_.setIsInterval})(B),J=a(341),Q=function(e){return Object(n.jsxs)(J.a,{title:"Basic Modal",visible:e.isModalVisible,onOk:e.handleOk,onCancel:e.handleCancel,children:[Object(n.jsx)("p",{children:"Some contents..."}),Object(n.jsx)("p",{children:"Some contents..."}),Object(n.jsx)("p",{children:"Some contents..."})]})},W=a(337),X=a(176),Z=a(83),$=a(51),ee=a(339),te=a(347),ae=function(e){var t=Object(r.useState)(e.element.type),a=Object(i.a)(t,2),s=a[0],c=a[1],l=Object(r.useState)(!1),o=Object(i.a)(l,2),u=o[0],d=o[1];return Object(n.jsx)(ee.a.Item,{action:!0,className:"py-1",children:Object(n.jsxs)(Z.a,{children:[Object(n.jsx)($.a,{className:"mx-2",children:Object(n.jsx)(q.a,{onChange:function(e){console.log(e.target.checked),e.target.checked?c("completed"):c("active")}})}),Object(n.jsx)($.a,{className:"mx-2",children:e.element.time.split(":",2).join(":")}),Object(n.jsx)($.a,{className:"mx-2",children:Object(n.jsx)(X.a,{placement:"topLeft",title:e.element.descriptions,children:Object(n.jsx)("span",{style:{textDecoration:"completed"===s?"line-through":""},children:e.element.name})},e.element.id)}),Object(n.jsx)($.a,{className:"mr-0 ml-auto",children:u?Object(n.jsx)(O.a,{size:"small"},"spin"):Object(n.jsx)(v.a,{className:"",type:"primary",shape:"circle",size:"small",style:{marginLeft:10},onClick:function(){var t;t=e.element.id,console.log(t),d(!0),e.deleteTask(t,e.dateInterval.startDate.format("YYYY-MM-DD"),e.dateInterval.endDate.format("YYYY-MM-DD"))},icon:Object(n.jsx)("div",{className:"d-flex flex-wrap align-content-start",children:Object(n.jsx)(te.a,{className:"ml-1",style:{fontSize:"14px"}})})})})]})})},se=Object(o.b)((function(e){return{dateInterval:e.task.dateInterval}}),{deleteTask:function(e,t,a){return function(){var s=Object(M.a)(T.a.mark((function s(n,r){var c;return T.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,F(e);case 2:c=s.sent,console.log(c),null!==c&&(n(_.setErrorMessage("Task deletion was successful")),n(H(t,a)),n(_.setErrorMessage(null)));case 5:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}()},getTaskListForGap:H})(ae),ne=function(e){var t=Object(r.useState)({startDate:j()(null),endDate:j()()}),a=Object(i.a)(t,2),s=a[0],c=a[1];return Object(r.useEffect)((function(){e.dateInterval.startDate.format("YYYY-MM-DD")===s.startDate.format("YYYY-MM-DD")&&e.dateInterval.endDate.format("YYYY-MM-DD")===s.endDate.format("YYYY-MM-DD")||null!==e.dateInterval.startDate&&null!==e.dateInterval.startDate&&(console.log(e.dateInterval.startDate.format("YYYY-MM-DD")," - ",e.dateInterval.endDate.format("YYYY-MM-DD")),e.getTaskListForGap(e.dateInterval.startDate.format("YYYY-MM-DD"),e.dateInterval.endDate.format("YYYY-MM-DD")),c(e.dateInterval))}),[e.dateInterval]),Object(r.useEffect)((function(){null!==e.errorMessage&&D.b.success(e.errorMessage)}),[e.errorMessage]),null!==e.taskList?Object(n.jsxs)(n.Fragment,{children:[e.taskListIsFetching?Object(n.jsx)(O.a,{size:"large"},"spin"):null,re(e.taskList)]}):Object(n.jsx)(O.a,{size:"large"},"spin")},re=function e(t){var a=function(e){return"date"===e?function(e,t){return e.date>t.date?1:-1}:function(e,t){return e.time>t.time?-1:1}};t.sort(a("time")).sort(a("date"));var s=[],r=[],c=function(e){return j()(e.date).format("DD MMMM")},l=null;null!==t&&t.length>0&&(l=c(t[0]),s.push(Object(n.jsxs)("h3",{children:[l,":"]},l+"title")));for(var o=0;o<24;o++){if(!(t.length>0)){s.push(Object(n.jsx)("h3",{children:"no tasks"}));break}if(s.push(Object(n.jsxs)(W.a,{orientation:"left",children:[o<=9?"0":null,o,":00"]},o+"to"+l)),null!==t)for(var i=0;i<t.length;i++){var u=t[i],d=Number(u.time.split(":",1));d>=o&&d<o+1&&(c(u)===l?s.push(Object(n.jsx)(X.a,{placement:"topLeft",title:u.descriptions,children:Object(n.jsx)(se,{element:u})},o+"-"+u.id)):r.push(u))}}return r.length>0&&(s=s.concat(e(r))),s},ce=Object(o.b)((function(e){return{taskList:e.task.taskList,taskSaveStatus:e.task.taskSaveStatus,taskListIsFetching:e.task.taskListIsFetching,dateInterval:e.task.dateInterval,errorMessage:e.task.errorMessage}}),{getTaskListForGap:H})(ne),le=function(e){var t=Object(r.useState)(j()()),a=Object(i.a)(t,2),s=a[0],c=a[1],l=Object(r.useState)(!1),o=Object(i.a)(l,2),d=o[0],f=o[1],m=Object(r.useState)(!1),b=Object(i.a)(m,2),D=b[0],h=b[1],p=Object(r.useState)(!1),g=Object(i.a)(p,2),O=g[0],v=g[1];return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"site-card-border-less-wrapper",children:[Object(n.jsxs)(u.a,{title:Object(n.jsx)(U,{onDateChange:function(e,t){console.log("2) onDateChange value:",e),null!==e?(c(e),h(!1)):(c(j()(null)),h(!0))},getTaskList:e.getTaskList,selectedDate:s,setSelectedDate:c,showDrawer:function(){f(!0)},isAddActive:D,onGapDateChange:function(t,a){console.log("onGapDateChange"),null!==t&&null!==t[0]&&null!==t[1]&&e.getTaskListForGap(t[0].format("YYYY-MM-DD"),t[1].format("YYYY-MM-DD"))},showModal:function(){v(!0)}}),bordered:!1,children:[Object(n.jsxs)(Q,{isModalVisible:O,handleOk:function(){v(!1)},handleCancel:function(){v(!1)},children:[Object(n.jsx)("p",{children:"Some contents..."}),Object(n.jsx)("p",{children:"Some contents..."}),Object(n.jsx)("p",{children:"Some contents..."})]}),Object(n.jsx)(ce,{})]}),Object(n.jsx)(G,{selectedDate:s,onClose:function(){f(!1)},visible:d,setVisible:f})]})})},oe=Object(o.b)((function(e){return{taskList:e.task.taskList}}),{getTaskList:K,getTaskListForGap:H})(le),ie=(a(330),a(331),a(81)),ue=a(172),de=Object(ie.c)({task:V}),je=Object(ie.d)(de,Object(ie.a)(ue.a)),fe=function(){return Object(n.jsx)(o.a,{store:je,children:Object(n.jsx)("div",{className:"container-fluid",children:Object(n.jsx)(oe,{})})})},me=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,348)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),s(e),n(e),r(e),c(e)}))};l.a.render(Object(n.jsx)(fe,{}),document.getElementById("root")),me()}},[[332,1,2]]]);
//# sourceMappingURL=main.b8a036fa.chunk.js.map