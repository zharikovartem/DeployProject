(this["webpackJsonpepam-app"]=this["webpackJsonpepam-app"]||[]).push([[0],{260:function(e,t,a){},261:function(e,t,a){},266:function(e,t,a){},475:function(e,t,a){"use strict";a.r(t);var s,n=a(15),r=a(0),c=a(16),l=a.n(c),i=(a(260),a(261),a(58)),o=a(51),u=a(481),d=a(50),j=a(37),m=a.n(j),b=a(485),f=a(483),h=a(252),O=a(486),S=a(188),p=a(478),v=a(479),k=a(66),x=(a(266),a(161)),D=a(233),g=a.n(D),Y={labelCol:{span:8},wrapperCol:{span:16}},T={wrapperCol:{offset:8,span:16}},I=b.a.TextArea,M=function(e){var t=f.a.useForm(),a=Object(o.a)(t,1)[0],s=Object(r.useState)(m()()),c=Object(o.a)(s,2),l=c[0],i=c[1],u=Object(r.useState)(e.taskSaveStatus),j=Object(o.a)(u,2),D=j[0],M=j[1];Object(r.useEffect)((function(){switch(e.taskSaveStatus){case"inProgress":M(e.taskSaveStatus);break;case"success":h.b.success("The task was successfully created"),e.onClose(),M(""),N();break;case"error":h.b.error("Error: "+e.errorMessage),M(e.taskSaveStatus)}}),[e.taskSaveStatus]);var N=function(){a.resetFields()};return Object(n.jsx)(O.a,{title:"Create New Task for "+l.format("DD MMM YYYY"),placement:"right",closable:!0,onClose:e.onClose,visible:e.visible,width:"80%",children:Object(n.jsxs)(f.a,Object(d.a)(Object(d.a)({},Y),{},{form:a,name:"control-hooks",onFinish:function(t){var a={date:t.date.format("YYYY-MM-DD"),taskTime:t.taskTime.format("HH:mm"),taskName:t.taskName,user_id:1,description:t.description};m()(l.format("YYYY-MM-DD")).isBetween(e.dateInterval.startDate.format("YYYY-MM-DD"),e.dateInterval.endDate.format("YYYY-MM-DD"),void 0,"[]")?e.createNewTask(a,!0):e.createNewTask(a,!1)},children:[Object(n.jsx)(f.a.Item,{label:"Task name",name:"taskName",rules:[{required:!0,message:"Please input task name!"}],children:Object(n.jsx)(b.a,{})}),Object(n.jsx)(f.a.Item,{label:"Task date",name:"date",initialValue:l,rules:[{required:!0,message:"Please input task date!"}],children:Object(n.jsx)(S.a,{onChange:function(e,t){null!==e&&i(e)},format:"DD-MM-YYYY",autoComplete:"off"})}),Object(n.jsx)(f.a.Item,{label:"Task time",name:"taskTime",rules:[{required:!0,message:"Please input task time!"}],children:Object(n.jsx)(p.a,{format:"HH:mm"})}),Object(n.jsx)(f.a.Item,{label:"Description",name:"description",children:Object(n.jsx)(I,{rows:2})}),Object(n.jsx)(f.a.Item,Object(d.a)(Object(d.a)({},T),{},{children:"inProgress"===D?Object(n.jsx)(v.a,{}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(k.a,{type:"primary",htmlType:"submit",children:"Create"}),Object(n.jsx)(k.a,{className:"ml-3",type:"primary",onClick:N,children:"Reset"})]})})),Object(n.jsx)(x.b,{className:"date-picker-list",style:{backgroundColor:"white"},children:Object(n.jsx)(x.a,{locale:g.a,mode:"date",title:"Select Date",extra:"click to choose",value:new Date("2017-1-1"),onChange:function(e){console.log(e)},children:Object(n.jsx)(x.b.Item,{arrow:"horizontal",children:"Datetime"})})})]}))})},N=a(90),L=a.n(N),y=a(160),w=a(244),E=a.n(w).a.create({withCredentials:!0,baseURL:"https://crmapiserver.h1n.ru/api/"});!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(s||(s={}));var C=function(e){return E.post("tasks",e).then((function(e){return 200===e.status?e:null})).catch((function(e){return e.response?e.response:(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},_=function(e){return E.post("tasks/part",e).then((function(e){return 200===e.status?e:null})).catch((function(e){return e.response?e.response:(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},A=function(e){return E.delete("tasks/".concat(e)).then((function(e){return 200===e.status?e:null})).catch((function(e){return e.response?e.response:(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},F={taskList:null,taskListIsFetching:!1,taskSaveStatus:"no",errorMessage:null,isInterval:!1,dateInterval:{startDate:m()(),endDate:m()()}},K={setTaskList:function(e){return{type:"SN/TASK/SET_TASK_LIST",taskList:e}},setTaskSaveStatus:function(e){return{type:"SN/TASK/SET_TASK_SAVE_STATUS",taskSaveStatus:e}},setErrorMessage:function(e){return{type:"SN/TASK/SET_ERROR_MESSAGE",message:e}},setTaskListIsFetching:function(e){return{type:"SN/TASK/SET_TASK_LIST_IS_FETCHING",isFetchingValue:e}},setIsInterval:function(e,t){return{type:"SN/TASK/SET_IS_INTERVAL",isInterval:e,date:t}}},q=function(e,t){return function(){var a=Object(y.a)(L.a.mark((function a(s,n){var r,c;return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s(K.setTaskListIsFetching(!0)),r={start_date:e,end_date:t},a.next=4,_(r);case 4:void 0!==(c=a.sent)&&null!==c&&s(K.setTaskList(c.data)),s(K.setTaskListIsFetching(!1));case 7:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SN/TASK/SET_TASK_LIST":return Object(d.a)(Object(d.a)({},e),{},{taskList:t.taskList.Tasks});case"SN/TASK/SET_TASK_SAVE_STATUS":return Object(d.a)(Object(d.a)({},e),{},{taskSaveStatus:t.taskSaveStatus});case"SN/TASK/SET_ERROR_MESSAGE":return Object(d.a)(Object(d.a)({},e),{},{errorMessage:t.message});case"SN/TASK/SET_TASK_LIST_IS_FETCHING":return Object(d.a)(Object(d.a)({},e),{},{taskListIsFetching:t.isFetchingValue});case"SN/TASK/SET_IS_INTERVAL":var a={startDate:t.date.startDate,endDate:t.date.endDate};return Object(d.a)(Object(d.a)({},e),{},{isInterval:t.isInterval,dateInterval:a});default:return e}},R=Object(i.b)((function(e){return{taskList:e.task.taskList,taskSaveStatus:e.task.taskSaveStatus,errorMessage:e.task.errorMessage,dateInterval:e.task.dateInterval}}),{createNewTask:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){var a=Object(y.a)(L.a.mark((function a(s,n){var r,c,l,i;return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s(K.setTaskSaveStatus("inProgress")),a.next=3,C(e);case 3:(r=a.sent)&&r.status&&200===r.status?(t&&(c=n(),l=c.task.dateInterval.startDate.format("YYYY-MM-DD"),i=c.task.dateInterval.endDate.format("YYYY-MM-DD"),s(q(l,i))),s(K.setTaskSaveStatus("success")),s(K.setTaskSaveStatus("no"))):r&&r.data&&(s(K.setErrorMessage(r.data.message)),s(K.setTaskSaveStatus("error")),s(K.setTaskSaveStatus("no")),s(K.setErrorMessage(null)));case 5:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()}})(M),z=a(487),P=a(488),H=a(489),G=S.a.RangePicker,B=function(e){var t=Object(r.useState)(!1),a=Object(o.a)(t,2),s=a[0],c=a[1],l=Object(r.useState)({startDate:m()(),endDate:m()()}),i=Object(o.a)(l,2),u=i[0],d=i[1];Object(r.useEffect)((function(){e.dateInterval.startDate.format("YYYY-MM-DD")===u.startDate.format("YYYY-MM-DD")&&e.dateInterval.endDate.format("YYYY-MM-DD")===u.endDate.format("YYYY-MM-DD")||e.setIsInterval(s,u)}),[s,u,e]);return Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"col-12 col-md-8 col-lg-6",children:[Object(n.jsx)("div",{className:"d-none d-sm-inline",children:Object(n.jsxs)("label",{children:["Select ",s?"date interval":"date",":"]})}),Object(n.jsx)("div",{className:"d-inline",children:s?Object(n.jsx)(G,{onChange:function(e,t){null!==e&&null!==e[0]&&null!==e[1]&&d({startDate:e[0],endDate:e[1]})},defaultValue:[e.dateInterval.startDate,e.dateInterval.endDate],value:[e.dateInterval.startDate,e.dateInterval.endDate],format:"DD-MM-YYYY",style:{marginLeft:10}}):Object(n.jsx)(S.a,{onChange:function(e,t){null!==e&&d({startDate:e,endDate:e})},defaultValue:e.dateInterval.startDate,format:"DD-MM-YYYY",style:{marginLeft:10}})})]}),Object(n.jsx)("div",{className:"col-12 col-md-4 col-lg-2 m-2 m-md-0",children:Object(n.jsx)(z.a,{className:"ml-3",onChange:function(e){e.target.checked||d({startDate:u.startDate,endDate:u.startDate}),c(e.target.checked)},children:"Date interval"})}),Object(n.jsxs)("div",{className:"col-12 col-md-12 col-lg-4",children:[Object(n.jsx)(k.a,{type:"primary",shape:"round",icon:Object(n.jsxs)("div",{className:"d-flex flex-wrap align-content-start",children:[Object(n.jsx)(P.a,{style:{fontSize:"18px"}}),Object(n.jsx)("span",{className:"ml-1",style:{fontSize:"14px"},children:"Add"})]}),style:{marginLeft:10},onClick:e.showDrawer}),Object(n.jsx)(k.a,{className:"",type:"primary",shape:"round",style:{marginLeft:10},onClick:e.showModal,icon:Object(n.jsxs)("div",{className:"d-flex flex-wrap align-content-start",children:[Object(n.jsx)(H.a,{style:{fontSize:"18px"}}),Object(n.jsx)("span",{className:"ml-1",style:{fontSize:"14px"},children:"Settings"})]})})]})]})},U=Object(i.b)((function(e){return{dateInterval:e.task.dateInterval}}),{setIsInterval:K.setIsInterval})(B),J=a(484),Q=function(e){return Object(n.jsxs)(J.a,{title:"Task display settings",visible:e.isModalVisible,onOk:e.handleOk,onCancel:e.handleCancel,children:[Object(n.jsx)("p",{children:"Some contents..."}),Object(n.jsx)("p",{children:"Some contents..."}),Object(n.jsx)("p",{children:"Some contents..."})]})},W=a(480),X=a(251),Z=a(108),$=a(59),ee=a(482),te=a(490),ae=function(e){var t=Object(r.useState)(e.element.type),a=Object(o.a)(t,2),s=a[0],c=a[1],l=Object(r.useState)(!1),i=Object(o.a)(l,2),u=i[0],d=i[1];return Object(n.jsx)(ee.a.Item,{action:!0,className:"py-1",children:Object(n.jsxs)(Z.a,{className:"px-0 ml-0 ml-sm-5",children:[Object(n.jsx)($.a,{className:"mx-2",children:Object(n.jsx)(z.a,{onChange:function(e){e.target.checked?c("completed"):c("active")}})}),Object(n.jsx)($.a,{className:"mx-2",children:e.element.time.split(":",2).join(":")}),Object(n.jsx)($.a,{className:"mx-2",children:Object(n.jsx)(X.a,{placement:"topLeft",title:e.element.descriptions,children:Object(n.jsx)("span",{style:{textDecoration:"completed"===s?"line-through":""},className:"text-break",children:e.element.name})},e.element.id)}),Object(n.jsx)($.a,{className:"mr-auto ml-0 mr-sm-2 ml-sm-auto",children:u?Object(n.jsx)(v.a,{size:"small"},"spin"):Object(n.jsx)(k.a,{className:"",type:"primary",shape:"circle",size:"small",style:{marginLeft:10},onClick:function(){var t;t=e.element.id,d(!0),e.deleteTask(t,e.dateInterval.startDate.format("YYYY-MM-DD"),e.dateInterval.endDate.format("YYYY-MM-DD"))},icon:Object(n.jsx)("div",{className:"d-flex flex-wrap align-content-start",children:Object(n.jsx)(te.a,{className:"ml-1",style:{fontSize:"14px"}})})})})]})})},se=Object(i.b)((function(e){return{dateInterval:e.task.dateInterval}}),{deleteTask:function(e,t,a){return function(){var s=Object(y.a)(L.a.mark((function s(n,r){return L.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,A(e);case 2:null!==s.sent&&(n(K.setErrorMessage("Task deletion was successful")),n(q(t,a)),n(K.setErrorMessage(null)));case 4:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}()},getTaskList:q})(ae),ne=function(e){return"date"===e?function(e,t){return e.date>t.date?1:-1}:function(e,t){return e.time>t.time?-1:1}},re=function(e){var t=Object(r.useState)({startDate:m()(null),endDate:m()()}),a=Object(o.a)(t,2),s=a[0],c=a[1];return Object(r.useEffect)((function(){e.dateInterval.startDate.format("YYYY-MM-DD")===s.startDate.format("YYYY-MM-DD")&&e.dateInterval.endDate.format("YYYY-MM-DD")===s.endDate.format("YYYY-MM-DD")||null!==e.dateInterval.startDate&&null!==e.dateInterval.startDate&&(e.getTaskList(e.dateInterval.startDate.format("YYYY-MM-DD"),e.dateInterval.endDate.format("YYYY-MM-DD")),c(e.dateInterval))}),[e.dateInterval]),Object(r.useEffect)((function(){null!==e.errorMessage&&h.b.success(e.errorMessage)}),[e.errorMessage]),null!==e.taskList?Object(n.jsx)(n.Fragment,{children:ce(e.taskList)}):Object(n.jsx)(v.a,{size:"large"},"spin")},ce=function e(t){var a=[],s=[];t.sort(ne("time")).sort(ne("date"));var r=function(e){return m()(e.date).format("DD MMMM")},c=null;null!==t&&t.length>0&&(c=r(t[0]),a.push(Object(n.jsxs)("h3",{children:[c,":"]},c+"title")));for(var l=0;l<24;l++){if(!(t.length>0)){a.push(Object(n.jsx)("h3",{children:"no tasks"}));break}if(a.push(Object(n.jsxs)(W.a,{orientation:"left",children:[l<=9?"0":null,l,":00"]},l+"to"+c)),null!==t)for(var i=0;i<t.length;i++){var o=t[i],u=Number(o.time.split(":",1));u>=l&&u<l+1&&(r(o)===c?a.push(Object(n.jsx)(X.a,{placement:"topLeft",title:o.descriptions,children:Object(n.jsx)(se,{element:o})},l+"-"+o.id)):s.push(o))}}return s.length>0&&(a=a.concat(e(s))),a},le=Object(i.b)((function(e){return{taskList:e.task.taskList,taskSaveStatus:e.task.taskSaveStatus,taskListIsFetching:e.task.taskListIsFetching,dateInterval:e.task.dateInterval,errorMessage:e.task.errorMessage}}),{getTaskList:q})(re),ie=function(e){var t=Object(r.useState)(!1),a=Object(o.a)(t,2),s=a[0],c=a[1],l=Object(r.useState)(!1),i=Object(o.a)(l,2),d=i[0],j=i[1];return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"site-card-border-less-wrapper",children:[Object(n.jsxs)(u.a,{title:Object(n.jsx)(U,{showDrawer:function(){c(!0)},showModal:function(){j(!0)}}),bordered:!1,children:[Object(n.jsx)(Q,{isModalVisible:d,handleOk:function(){j(!1)},handleCancel:function(){j(!1)}}),Object(n.jsx)(le,{})]}),Object(n.jsx)(R,{onClose:function(){c(!1)},visible:s,setVisible:c})]})})},oe=Object(i.b)((function(e){return{taskList:e.task.taskList}}),{getTaskList:q})(ie),ue=(a(472),a(473),a(474),a(105)),de=a(247),je=Object(ue.c)({task:V}),me=Object(ue.d)(je,Object(ue.a)(de.a)),be=function(){return Object(n.jsx)(i.a,{store:me,children:Object(n.jsx)("div",{className:"container-fluid",children:Object(n.jsx)(oe,{})})})},fe=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,491)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),s(e),n(e),r(e),c(e)}))};l.a.render(Object(n.jsx)(be,{}),document.getElementById("root")),fe()}},[[475,1,2]]]);
//# sourceMappingURL=main.64cc3e84.chunk.js.map