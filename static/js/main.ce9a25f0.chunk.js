(this["webpackJsonpepam-app"]=this["webpackJsonpepam-app"]||[]).push([[0],{184:function(e,t,s){},185:function(e,t,s){},331:function(e,t,s){"use strict";s.r(t);var a=s(8),n=s(0),c=s(24),r=s.n(c),i=(s(184),s(185),s(60)),l=s(47),o=s(338),u=s(48),j=s.n(u),d=s(43),b=s(342),h=s(176),m=s(343),f=s(340),O=s(130),p=s(335),g=s(336),S=s(53),k={labelCol:{span:8},wrapperCol:{span:16}},x={wrapperCol:{offset:8,span:16}},v=b.a.TextArea,T=function(e){var t=Object(n.useState)(e.selectedDate),s=Object(l.a)(t,2),c=s[0],r=s[1],i=Object(n.useState)(e.taskSaveStatus),o=Object(l.a)(i,2),u=o[0],j=o[1];Object(n.useEffect)((function(){switch(console.log("status changed: ",e.taskSaveStatus),e.taskSaveStatus){case"inProgress":j(e.taskSaveStatus);break;case"success":h.b.success("The task was successfully created"),e.onClose(),j("");break;case"error":h.b.error("Error: "+e.errorMessage),j(e.taskSaveStatus)}}),[e.taskSaveStatus]);return Object(a.jsx)(m.a,{title:"Create New Task for "+c.format("DD MMM YYYY"),placement:"right",closable:!0,onClose:e.onClose,visible:e.visible,width:"80%",children:Object(a.jsxs)(f.a,Object(d.a)(Object(d.a)({},k),{},{name:"basic",initialValues:{remember:!0},onFinish:function(t){console.log("onFinish, reload: ",c!==e.selectedDate);var s={date:t.date.format("YYYY-MM-DD"),taskTime:t.taskTime.format("HH:mm"),taskName:t.taskName,user_id:1,description:t.description};c.format("YYYY-MM-DD")!==e.selectedDate.format("YYYY-MM-DD")?(console.log("\u041f\u0415\u0420\u0415\u0420\u0418\u0421\u041e\u0412\u041a\u0418 \u041d\u0415\u0422"),e.createNewTask(s,!1)):(e.createNewTask(s,!0),console.log("\u041f\u0415\u0420\u0415\u0420\u0418\u0421\u041e\u0412\u041a\u0410"))},children:[Object(a.jsx)(f.a.Item,{label:"Task name",name:"taskName",rules:[{required:!0,message:"Please input task name!"}],children:Object(a.jsx)(b.a,{})}),Object(a.jsx)(f.a.Item,{label:"Task date",name:"date",initialValue:e.selectedDate,rules:[{required:!0,message:"Please input task date!"}],children:Object(a.jsx)(O.a,{onChange:function(e,t){null!==e&&r(e)},format:"DD-MM-YYYY"})}),Object(a.jsx)(f.a.Item,{label:"Task time",name:"taskTime",rules:[{required:!0,message:"Please input task time!"}],children:Object(a.jsx)(p.a,{onChange:function(e,t){},format:"HH:mm"})}),Object(a.jsx)(f.a.Item,{label:"Description",name:"description",children:Object(a.jsx)(v,{rows:2})}),Object(a.jsx)(f.a.Item,Object(d.a)(Object(d.a)({},x),{},{children:"inProgress"===u?Object(a.jsx)(g.a,{}):Object(a.jsx)(S.a,{type:"primary",htmlType:"submit",children:"Create"})}))]}))})},D=s(70),Y=s.n(D),L=s(118),M=s(169),N=s.n(M).a.create({withCredentials:!0,baseURL:"https://crmapiserver.h1n.ru/api/"}),y=function(e){return N.get("tasks?date=".concat(e)).then((function(e){return 200===e.status?e:null})).catch((function(e){return e.response?(console.log("err",e.response),e.response):(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},C=function(e){return N.post("tasks",e).then((function(e){return 200===e.status?e:null})).catch((function(e){return e.response?e.response:(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},w=function(e){return N.post("tasks/part",e).then((function(e){return 200===e.status?e:null})).catch((function(e){return e.response?e.response:(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},A=function(e){return"date"===e?function(e,t){return e.date>t.date?1:-1}:function(e,t){return e.time>t.time?-1:1}},I={taskList:null,taskListIsFetching:!1,taskSaveStatus:"no",errorMessage:null},_=function(e){return{type:"SN/TASK/SET_TASK_LIST",taskList:e}},F=function(e){return{type:"SN/TASK/SET_TASK_SAVE_STATUS",taskSaveStatus:e}},E=function(e){return{type:"SN/TASK/SET_ERROR_MESSAGE",message:e}},K=function(e){return{type:"SN/TASK/SET_TASK_LIST_IS_FETCHING",isFetchingValue:e}},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;Object(d.a)({},e);switch(t.type){case"SN/TASK/SET_TASK_LIST":return Object(d.a)(Object(d.a)({},e),{},{taskList:t.taskList.Tasks.sort(A("time")).sort(A("date"))});case"SN/TASK/SET_TASK_SAVE_STATUS":return Object(d.a)(Object(d.a)({},e),{},{taskSaveStatus:t.taskSaveStatus});case"SN/TASK/SET_ERROR_MESSAGE":return Object(d.a)(Object(d.a)({},e),{},{errorMessage:t.message});case"SN/TASK/SET_TASK_LIST_IS_FETCHING":return Object(d.a)(Object(d.a)({},e),{},{taskListIsFetching:t.isFetchingValue});default:return e}},V=Object(i.b)((function(e){return{taskList:e.task.taskList,taskSaveStatus:e.task.taskSaveStatus,errorMessage:e.task.errorMessage}}),{createNewTask:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){var s=Object(L.a)(Y.a.mark((function s(a,n){var c;return Y.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a(F("inProgress")),s.next=3,C(e);case 3:200===(c=s.sent).status?(t&&a(_(c.data)),a(F("success")),a(F("no"))):(a(E(c.data.message)),a(F("error")),a(F("no")),a(E(null)));case 5:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}()}})(T),P=s(344),G=s(345),R=s(346),z=O.a.RangePicker,H=function(e){var t=Object(n.useState)(!1),s=Object(l.a)(t,2),c=s[0],r=s[1],i=Object(n.useState)("date"),o=Object(l.a)(i,2),u=o[0],j=o[1];return Object(a.jsxs)("div",{className:"row",children:[Object(a.jsxs)("div",{className:"col-12 col-md-8 col-lg-6",children:[Object(a.jsx)("div",{className:"d-none d-sm-inline",children:Object(a.jsxs)("label",{children:["Select ",u,":"]})}),Object(a.jsx)("div",{className:"d-inline",children:c?Object(a.jsx)(z,{onChange:e.onGapDateChange,defaultValue:[e.selectedDate,e.selectedDate],format:"DD-MM-YYYY",style:{marginLeft:10}}):Object(a.jsx)(O.a,{onChange:e.onDateChange,defaultValue:e.selectedDate,format:"DD-MM-YYYY",style:{marginLeft:10}})})]}),Object(a.jsx)("div",{className:"col-12 col-md-4 col-lg-2 m-2 m-md-0",children:Object(a.jsx)(P.a,{className:"ml-3",onChange:function(t){r(t.target.checked),t.target.checked?j("interval"):(j("date"),console.log("1 date selected: ",e.selectedDate.format("YYYY-MM-DD")),e.getTaskList(e.selectedDate.format("YYYY-MM-DD")))},children:"Date interval"})}),Object(a.jsxs)("div",{className:"col-12 col-md-12 col-lg-4",children:[Object(a.jsx)(S.a,{type:"primary",shape:"round",icon:Object(a.jsxs)("div",{className:"d-flex flex-wrap align-content-start",children:[Object(a.jsx)(G.a,{style:{fontSize:"18px"}}),Object(a.jsx)("span",{className:"ml-1",style:{fontSize:"14px"},children:"Add"})]}),style:{marginLeft:10},onClick:e.showDrawer,disabled:e.isAddActive}),Object(a.jsx)(S.a,{className:"",type:"primary",shape:"round",style:{marginLeft:10},onClick:e.showModal,icon:Object(a.jsxs)("div",{className:"d-flex flex-wrap align-content-start",children:[Object(a.jsx)(R.a,{style:{fontSize:"18px"}}),Object(a.jsx)("span",{className:"ml-1",style:{fontSize:"14px"},children:"Settings"})]})})]})]})},B=s(341),U=function(e){return Object(a.jsxs)(B.a,{title:"Basic Modal",visible:e.isModalVisible,onOk:e.handleOk,onCancel:e.handleCancel,children:[Object(a.jsx)("p",{children:"Some contents..."}),Object(a.jsx)("p",{children:"Some contents..."}),Object(a.jsx)("p",{children:"Some contents..."})]})},J=s(337),Q=s(177),W=s(81),X=s(49),Z=s(339),$=function(e){var t=Object(n.useState)(e.element.type),s=Object(l.a)(t,2),c=s[0],r=s[1];return Object(a.jsx)(Z.a.Item,{action:!0,className:"py-1",children:Object(a.jsxs)(W.a,{children:[Object(a.jsx)(X.a,{className:"mx-2",children:Object(a.jsx)(P.a,{onChange:function(e){console.log(e.target.checked),e.target.checked?r("completed"):r("active")}})}),Object(a.jsx)(X.a,{className:"mx-2",children:e.element.time.split(":",2).join(":")}),Object(a.jsx)(X.a,{className:"mx-2",children:Object(a.jsx)(Q.a,{placement:"topLeft",title:e.element.descriptions,children:Object(a.jsx)("span",{style:{textDecoration:"completed"===c?"line-through":""},children:e.element.name})},e.element.id)})]})})},ee=function e(t){var s=function(e){return"date"===e?function(e,t){return e.date>t.date?1:-1}:function(e,t){return e.time>t.time?-1:1}};t.sort(s("time")).sort(s("date"));var n=[],c=[],r=function(e){return j()(e.date).format("DD MMMM")},i=null;null!==t&&t.length>0&&(i=r(t[0]),n.push(Object(a.jsxs)("h3",{children:[i,":"]},i+"title")));for(var l=0;l<24;l++)if(n.push(Object(a.jsxs)(J.a,{orientation:"left",children:[l<=9?"0":null,l,":00"]},l+"to"+i)),null!==t)for(var o=0;o<t.length;o++){var u=t[o],d=Number(u.time.split(":",1));d>=l&&d<l+1&&(r(u)===i?n.push(Object(a.jsx)(Q.a,{placement:"topLeft",title:u.descriptions,children:Object(a.jsx)($,{element:u})},l+"-"+u.id)):c.push(u))}return c.length>0&&(n=n.concat(e(c))),n},te=function(e){return Object(n.useEffect)((function(){console.log("props.taskListIsFetching",e.taskListIsFetching)}),[e.taskListIsFetching]),null!==e.taskList?Object(a.jsx)(a.Fragment,{children:e.taskListIsFetching?Object(a.jsx)(g.a,{size:"large"},"spin"):ee(e.taskList)}):Object(a.jsx)(g.a,{size:"large"},"spin")},se=Object(i.b)((function(e){return{taskList:e.task.taskList,taskSaveStatus:e.task.taskSaveStatus,taskListIsFetching:e.task.taskListIsFetching}}),{})(te),ae=function(e){var t=Object(n.useState)(j()()),s=Object(l.a)(t,2),c=s[0],r=s[1],i=Object(n.useState)(!1),u=Object(l.a)(i,2),d=u[0],b=u[1],h=Object(n.useState)(!1),m=Object(l.a)(h,2),f=m[0],O=m[1],p=Object(n.useState)(!1),g=Object(l.a)(p,2),S=g[0],k=g[1];Object(n.useEffect)((function(){e.getTaskList(c.format("YYYY-MM-DD"))}),[c]);return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"site-card-border-less-wrapper",children:[Object(a.jsxs)(o.a,{title:Object(a.jsx)(H,{onDateChange:function(e,t){console.log("2) onDateChange value:",e),null!==e?(r(e),O(!1)):(r(j()(null)),O(!0))},getTaskList:e.getTaskList,selectedDate:c,setSelectedDate:r,showDrawer:function(){b(!0)},isAddActive:f,onGapDateChange:function(t,s){null!==t&&null!==t[0]&&null!==t[1]&&e.getTaskListForGap(t[0].format("YYYY-MM-DD"),t[1].format("YYYY-MM-DD"))},showModal:function(){k(!0)}}),bordered:!1,children:[Object(a.jsxs)(U,{isModalVisible:S,handleOk:function(){k(!1)},handleCancel:function(){k(!1)},children:[Object(a.jsx)("p",{children:"Some contents..."}),Object(a.jsx)("p",{children:"Some contents..."}),Object(a.jsx)("p",{children:"Some contents..."})]}),Object(a.jsx)(se,{})]}),Object(a.jsx)(V,{selectedDate:c,onClose:function(){b(!1)},visible:d,setVisible:b})]})})},ne=Object(i.b)((function(e){return{taskList:e.task.taskList}}),{getTaskList:function(e){return function(){var t=Object(L.a)(Y.a.mark((function t(s,a){var n;return Y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s(K(!0)),console.log("setTaskListIsFetching true"),t.next=4,y(e);case 4:null!==(n=t.sent)&&(s(_(n.data)),s(K(!1)),console.log("setTaskListIsFetching false"));case 6:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}()},getTaskListForGap:function(e,t){return function(){var s=Object(L.a)(Y.a.mark((function s(a,n){var c;return Y.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a(K(!0)),s.next=3,w({start_date:e,end_date:t});case 3:null!==(c=s.sent)&&a(_(c.data)),a(K(!1));case 6:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}()}})(ae),ce=(s(329),s(330),s(80)),re=s(172),ie=Object(ce.c)({task:q}),le=Object(ce.d)(ie,Object(ce.a)(re.a)),oe=function(){return Object(a.jsx)(i.a,{store:le,children:Object(a.jsx)("div",{className:"container-fluid",children:Object(a.jsx)(ne,{})})})},ue=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,347)).then((function(t){var s=t.getCLS,a=t.getFID,n=t.getFCP,c=t.getLCP,r=t.getTTFB;s(e),a(e),n(e),c(e),r(e)}))};r.a.render(Object(a.jsx)(oe,{}),document.getElementById("root")),ue()}},[[331,1,2]]]);
//# sourceMappingURL=main.ce9a25f0.chunk.js.map