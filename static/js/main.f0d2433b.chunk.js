(this["webpackJsonpepam-app"]=this["webpackJsonpepam-app"]||[]).push([[0],{184:function(e,t,s){},185:function(e,t,s){},331:function(e,t,s){"use strict";s.r(t);var a=s(8),n=s(0),c=s(24),r=s.n(c),l=(s(184),s(185),s(77)),o=s(44),i=s(337),u=s(177),j=s(336),d=s(338),b=s(48),m=s.n(b),f=s(47),h=s(342),O=s(176),p=s(343),g=s(340),S=s(130),x=s(335),k=s(53),v={labelCol:{span:8},wrapperCol:{span:16}},D={wrapperCol:{offset:8,span:16}},Y=h.a.TextArea,T=function(e){var t=Object(n.useState)(e.selectedDate),s=Object(o.a)(t,2),c=s[0],r=s[1],l=Object(n.useState)(e.taskSaveStatus),i=Object(o.a)(l,2),u=i[0],d=i[1];Object(n.useEffect)((function(){switch(e.taskSaveStatus){case"inProgress":d(e.taskSaveStatus);break;case"success":O.b.success("The task was successfully created"),e.onClose(),d("");break;case"error":O.b.error("Error: "+e.errorMessage),d(e.taskSaveStatus)}}),[e.taskSaveStatus]);return Object(a.jsx)(p.a,{title:"Create New Task for "+c.format("DD MMM YYYY"),placement:"right",closable:!0,onClose:e.onClose,visible:e.visible,width:"80%",children:Object(a.jsxs)(g.a,Object(f.a)(Object(f.a)({},v),{},{name:"basic",initialValues:{remember:!0},onFinish:function(t){console.log("onFinish, reload: ",c!==e.selectedDate);var s={date:t.date.format("YYYY-MM-DD"),taskTime:t.taskTime.format("HH:mm"),taskName:t.taskName,user_id:1,description:t.description};c.format("YYYY-MM-DD")!==e.selectedDate.format("YYYY-MM-DD")?(console.log("\u041f\u0415\u0420\u0415\u0420\u0418\u0421\u041e\u0412\u041a\u0418 \u041d\u0415\u0422"),e.createNewTask(s,!1)):(e.createNewTask(s,!0),console.log("\u041f\u0415\u0420\u0415\u0420\u0418\u0421\u041e\u0412\u041a\u0410"))},children:[Object(a.jsx)(g.a.Item,{label:"Task name",name:"taskName",rules:[{required:!0,message:"Please input task name!"}],children:Object(a.jsx)(h.a,{})}),Object(a.jsx)(g.a.Item,{label:"Task date",name:"date",initialValue:e.selectedDate,rules:[{required:!0,message:"Please input task date!"}],children:Object(a.jsx)(S.a,{onChange:function(e,t){null!==e&&r(e)},format:"DD-MM-YYYY"})}),Object(a.jsx)(g.a.Item,{label:"Task time",name:"taskTime",rules:[{required:!0,message:"Please input task time!"}],children:Object(a.jsx)(x.a,{onChange:function(e,t){},format:"HH:mm"})}),Object(a.jsx)(g.a.Item,{label:"Description",name:"description",children:Object(a.jsx)(Y,{rows:2})}),Object(a.jsx)(g.a.Item,Object(f.a)(Object(f.a)({},D),{},{children:"inProgress"===u?Object(a.jsx)(j.a,{}):Object(a.jsx)(k.a,{type:"primary",htmlType:"submit",children:"Create"})}))]}))})},M=s(69),L=s.n(M),N=s(118),w=s(169),y=s.n(w).a.create({withCredentials:!0,baseURL:"https://crmapiserver.h1n.ru/api/"}),C=function(e){return y.get("tasks?date=".concat(e)).then((function(e){return console.log(e.status),200===e.status?e:null})).catch((function(e){return e.response?(console.log("err",e.response),e.response):(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},A=function(e){return y.post("tasks",e).then((function(e){return 200===e.status?e:null})).catch((function(e){return e.response?e.response:(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},E=function(e){return y.post("tasks/part",e).then((function(e){return 200===e.status?e:null})).catch((function(e){return e.response?e.response:(e.request?console.log("request",e.request):console.log("anything else: ",e),null)}))},_=function(e){return"date"===e?function(e,t){return e.date>t.date?1:-1}:function(e,t){return e.time>t.time?-1:1}},q={taskList:null,taskSaveStatus:"no",errorMessage:null},P=function(e){return{type:"SN/TASK/SET_TASK_LIST",taskList:e}},I=function(e){return{type:"SN/TASK/SET_TASK_SAVE_STATUS",taskSaveStatus:e}},K=function(e){return{type:"SN/TASK/SET_ERROR_MESSAGE",message:e}},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;Object(f.a)({},e);switch(t.type){case"SN/TASK/SET_TASK_LIST":return Object(f.a)(Object(f.a)({},e),{},{taskList:t.taskList.Tasks.sort(_("time")).sort(_("date"))});case"SN/TASK/SET_TASK_SAVE_STATUS":return Object(f.a)(Object(f.a)({},e),{},{taskSaveStatus:t.taskSaveStatus});case"SN/TASK/SET_ERROR_MESSAGE":return Object(f.a)(Object(f.a)({},e),{},{errorMessage:t.message});default:return e}},R=Object(l.b)((function(e){return{taskList:e.task.taskList,taskSaveStatus:e.task.taskSaveStatus,errorMessage:e.task.errorMessage}}),{createNewTask:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){var s=Object(N.a)(L.a.mark((function s(a,n){var c;return L.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a(I("inProgress")),console.log("setTaskSaveStatus inProgress"),s.next=4,A(e);case 4:c=s.sent,console.log("taskList: ",c),200===c.status?(console.log("RESPONSE: ",c),t&&(a(P(c.data)),a(I("success")),a(I("no")))):(a(K(c.data.message)),a(I("error")),a(I("no")),a(K(null)));case 7:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}()}})(T),V=s(344),z=s(345),G=s(346),H=S.a.RangePicker,B=function(e){var t=Object(n.useState)(!1),s=Object(o.a)(t,2),c=s[0],r=s[1],l=Object(n.useState)("date"),i=Object(o.a)(l,2),u=i[0],j=i[1];return Object(a.jsxs)("div",{className:"row",children:[Object(a.jsxs)("div",{className:"col-12 col-md-8 col-lg-6",children:[Object(a.jsx)("div",{className:"d-none d-sm-inline",children:Object(a.jsxs)("label",{children:["Select ",u,":"]})}),Object(a.jsx)("div",{className:"d-inline",children:c?Object(a.jsx)(H,{onChange:e.onGapDateChange,defaultValue:[e.selectedDate,e.selectedDate],format:"DD-MM-YYYY",style:{marginLeft:10}}):Object(a.jsx)(S.a,{onChange:e.onDateChange,defaultValue:e.selectedDate,format:"DD-MM-YYYY",style:{marginLeft:10}})})]}),Object(a.jsx)("div",{className:"col-12 col-md-4 col-lg-2 m-2 m-md-0",children:Object(a.jsx)(V.a,{className:"ml-3",onChange:function(t){r(t.target.checked),t.target.checked?j("interval"):(j("date"),console.log("1 date selected: ",e.selectedDate.format("YYYY-MM-DD")),e.getTaskList(e.selectedDate.format("YYYY-MM-DD")))},children:"Date interval"})}),Object(a.jsxs)("div",{className:"col-12 col-md-12 col-lg-4",children:[Object(a.jsx)(k.a,{type:"primary",shape:"round",icon:Object(a.jsxs)("div",{className:"d-flex flex-wrap align-content-start",children:[Object(a.jsx)(z.a,{style:{fontSize:"18px"}}),Object(a.jsx)("span",{className:"ml-1",style:{fontSize:"14px"},children:"Add"})]}),style:{marginLeft:10},onClick:e.showDrawer,disabled:e.isAddActive}),Object(a.jsx)(k.a,{className:"",type:"primary",shape:"round",style:{marginLeft:10},onClick:e.showModal,icon:Object(a.jsxs)("div",{className:"d-flex flex-wrap align-content-start",children:[Object(a.jsx)(G.a,{style:{fontSize:"18px"}}),Object(a.jsx)("span",{className:"ml-1",style:{fontSize:"14px"},children:"Settings"})]})})]})]})},U=s(341),J=function(e){return Object(a.jsxs)(U.a,{title:"Basic Modal",visible:e.isModalVisible,onOk:e.handleOk,onCancel:e.handleCancel,children:[Object(a.jsx)("p",{children:"Some contents..."}),Object(a.jsx)("p",{children:"Some contents..."}),Object(a.jsx)("p",{children:"Some contents..."})]})},Q=s(81),W=s(49),X=s(339),Z=function(e){var t=Object(n.useState)(e.element.type),s=Object(o.a)(t,2),c=s[0],r=s[1];return Object(a.jsx)(X.a.Item,{action:!0,className:"py-1",children:Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(W.a,{className:"mx-2",children:Object(a.jsx)(V.a,{onChange:function(e){console.log(e.target.checked),e.target.checked?r("completed"):r("active")}})}),Object(a.jsx)(W.a,{className:"mx-2",children:e.element.time.split(":",2).join(":")}),Object(a.jsx)(W.a,{className:"mx-2",children:Object(a.jsx)(u.a,{placement:"topLeft",title:e.element.descriptions,children:Object(a.jsx)("span",{style:{textDecoration:"completed"===c?"line-through":""},children:e.element.name})},e.element.id)})]})})},$=function e(t){var s=function(e){return"date"===e?function(e,t){return e.date>t.date?1:-1}:function(e,t){return e.time>t.time?-1:1}};t.sort(s("time")).sort(s("date"));var n=[],c=[],r=function(e){return m()(e.date).format("DD MMMM")},l=null;null!==t&&t.length>0&&(l=r(t[0]),n.push(Object(a.jsxs)("h3",{children:[l,":"]},l+"title")));for(var o=0;o<24;o++)if(n.push(Object(a.jsxs)(i.a,{orientation:"left",children:[o<=9?"0":null,o,":00"]},o+"to"+l)),null!==t)for(var j=0;j<t.length;j++){var d=t[j],b=Number(d.time.split(":",1));b>=o&&b<o+1&&(r(d)===l?n.push(Object(a.jsx)(u.a,{placement:"topLeft",title:d.descriptions,children:Object(a.jsx)(Z,{element:d})},o+"-"+d.id)):c.push(d))}return c.length>0&&(n=n.concat(e(c))),n},ee=function(e){var t=Object(n.useState)(m()()),s=Object(o.a)(t,2),c=s[0],r=s[1],l=Object(n.useState)(!1),i=Object(o.a)(l,2),u=i[0],b=i[1],f=Object(n.useState)(!1),h=Object(o.a)(f,2),O=h[0],p=h[1],g=Object(n.useState)(null),S=Object(o.a)(g,2),x=S[0],k=S[1],v=Object(n.useState)(!1),D=Object(o.a)(v,2),Y=D[0],T=D[1];Object(n.useEffect)((function(){e.getTaskList(c.format("YYYY-MM-DD"))}),[c]),Object(n.useEffect)((function(){null!==e.taskList?(console.log("1) props in useEffect taskList:",e.taskList),k($(e.taskList))):k([Object(a.jsx)(j.a,{size:"large"},"spin")])}),[e.taskList]);return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"site-card-border-less-wrapper",children:[Object(a.jsxs)(d.a,{title:Object(a.jsx)(B,{onDateChange:function(e,t){console.log("2) onDateChange value:",e),null!==e?(k([Object(a.jsx)(j.a,{size:"large"},"spin")]),r(e),p(!1)):(r(m()(null)),p(!0))},getTaskList:e.getTaskList,selectedDate:c,setSelectedDate:r,showDrawer:function(){b(!0)},isAddActive:O,onGapDateChange:function(t,s){console.log("3) onGapDateChange value",t),k([Object(a.jsx)(j.a,{size:"large"},"spin")]),null!==t&&null!==t[0]&&null!==t[1]&&e.getTaskListForGap(t[0].format("YYYY-MM-DD"),t[1].format("YYYY-MM-DD"))},showModal:function(){T(!0)}}),bordered:!1,children:[Object(a.jsxs)(J,{isModalVisible:Y,handleOk:function(){T(!1)},handleCancel:function(){T(!1)},children:[Object(a.jsx)("p",{children:"Some contents..."}),Object(a.jsx)("p",{children:"Some contents..."}),Object(a.jsx)("p",{children:"Some contents..."})]}),x]}),Object(a.jsx)(R,{selectedDate:c,onClose:function(){b(!1)},visible:u,setVisible:b})]})})},te=Object(l.b)((function(e){return{taskList:e.task.taskList}}),{getTaskList:function(e){return function(){var t=Object(N.a)(L.a.mark((function t(s,a){var n;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C(e);case 2:null!==(n=t.sent)?s(P(n.data)):console.log("taskList === null");case 4:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}()},getTaskListForGap:function(e,t){return function(){var s=Object(N.a)(L.a.mark((function s(a,n){var c;return L.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,E({start_date:e,end_date:t});case 2:c=s.sent,a(P(c.data));case 4:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}()}})(ee),se=(s(329),s(330),s(80)),ae=s(172),ne=Object(se.c)({task:F}),ce=Object(se.d)(ne,Object(se.a)(ae.a)),re=function(){return Object(a.jsx)(l.a,{store:ce,children:Object(a.jsx)("div",{className:"container-fluid",children:Object(a.jsx)(te,{})})})},le=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,347)).then((function(t){var s=t.getCLS,a=t.getFID,n=t.getFCP,c=t.getLCP,r=t.getTTFB;s(e),a(e),n(e),c(e),r(e)}))};r.a.render(Object(a.jsx)(re,{}),document.getElementById("root")),le()}},[[331,1,2]]]);
//# sourceMappingURL=main.f0d2433b.chunk.js.map